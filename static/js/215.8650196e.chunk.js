"use strict";(self.webpackChunkplan=self.webpackChunkplan||[]).push([[215],{215:(e,n,s)=>{s.r(n),s.d(n,{default:()=>c});var r=s(43),a=s(472),t=s(791),i=s(729),d=s(999),o=s(579);const l={pageWrapper:{backgroundColor:"#003f66",minHeight:"100vh",padding:"20px"},container:{display:"flex",height:"calc(100vh - 40px)",borderRadius:"12px",overflow:"hidden",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",backgroundColor:"#ffffff",marginTop:"60px"},sidebar:{width:"30%",borderRight:"1px solid #ddd",backgroundColor:"#f9f9f9",overflowY:"auto"},sidebarHeader:{margin:0,padding:"16px",borderBottom:"1px solid #ddd",fontSize:"18px",backgroundColor:"#e6f7ff",color:"#003f66"},contact:{padding:"12px 16px",cursor:"pointer",borderBottom:"1px solid #eee",color:"#003f66"},chatbox:{width:"70%",display:"flex",flexDirection:"column",backgroundColor:"#fafafa"},chatHeader:{padding:"16px",backgroundColor:"#e6f7ff",borderBottom:"1px solid #ddd",color:"#003f66",fontWeight:"600"},chatBody:{flex:1,padding:"16px",overflowY:"auto",display:"flex",flexDirection:"column",gap:"12px"},messageBubble:{maxWidth:"60%",padding:"12px",borderRadius:"12px",boxShadow:"0 1px 2px rgba(0,0,0,0.1)"},messageText:{margin:0,color:"#333"},messageMeta:{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"8px",marginTop:"6px",fontSize:"12px",color:"#555"},metaName:{fontWeight:"500"},metaTime:{},metaStatus:{fontSize:"14px"},chatInput:{display:"flex",borderTop:"1px solid #ddd",padding:"12px",backgroundColor:"#fff"},input:{flex:1,padding:"10px 14px",borderRadius:"20px",border:"1px solid #ccc",outline:"none",marginRight:"12px"},sendBtn:{padding:"10px 18px",backgroundColor:"#25D366",color:"#fff",border:"none",borderRadius:"20px",cursor:"pointer"},noChat:{flex:1,display:"flex",justifyContent:"center",alignItems:"center",color:"#777",fontSize:"16px"}},c=()=>{const[e,n]=(0,r.useState)([]),[s,c]=(0,r.useState)(null),[x,f]=(0,r.useState)([]),[p,u]=(0,r.useState)(""),[h,m]=(0,r.useState)(""),g=(0,i.xI)().currentUser,b=(0,r.useRef)(null);(0,r.useEffect)((()=>{(async()=>{if(!g)return;const e=(0,a.H9)(t.db,"user",g.uid),n=await(0,a.x7)(e);if(n.exists()){const e=n.data();m(e.fullName||"")}})()}),[g]),(0,r.useEffect)((()=>{var e;null===(e=b.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[x]),(0,r.useEffect)((()=>{if(!g)return;return(0,a.aQ)((0,a.P)((0,a.rJ)(t.db,"webchat"),(0,a._M)("receiverId","==",g.uid)),(e=>{const s=e.docs.map((e=>e.data())),r=Array.from(new Map(s.map((e=>[e.senderId,e]))).values());n(r)}))}),[g]),(0,r.useEffect)((()=>{if(!s||!g)return;const e=(0,a.P)((0,a.rJ)(t.db,"webchat"),(0,a._M)("senderId","in",[g.uid,s.senderId]),(0,a._M)("receiverId","in",[g.uid,s.senderId]),(0,a.My)("time"),(0,a.AB)(50));return(0,a.aQ)(e,(e=>{const n=e.docs.map((e=>({id:e.id,...e.data()})));f(n),e.docs.forEach((async e=>{const n=e.data();n.receiverId===g.uid&&"seen"!==n.status&&await(0,a.mZ)((0,a.H9)(t.db,"webchat",e.id),{status:"seen"})}))}))}),[s,g]);const v=(0,r.useCallback)((async()=>{p.trim()&&g&&s&&(await(0,a.gS)((0,a.rJ)(t.db,"webchat"),{senderId:g.uid,receiverId:s.senderId,senderName:h||"Anonymous",receiverName:s.senderName,message:p.trim(),time:(0,a.O5)(),status:"sent"}),u(""))}),[p,g,s,h]);return(0,o.jsxs)("div",{style:l.pageWrapper,children:[(0,o.jsx)(d.A,{})," ",(0,o.jsxs)("div",{style:l.container,children:[(0,o.jsxs)("div",{style:l.sidebar,children:[(0,o.jsx)("h3",{style:l.sidebarHeader,children:"Chats"}),e.map((e=>(0,o.jsx)("div",{style:{...l.contact,backgroundColor:(null===s||void 0===s?void 0:s.senderId)===e.senderId?"#e6f7ff":"#ffffff"},onClick:()=>c(e),children:e.senderName},e.senderId)))]}),(0,o.jsx)("div",{style:l.chatbox,children:s?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{style:l.chatHeader,children:["Chat with ",(0,o.jsx)("strong",{children:s.senderName})]}),(0,o.jsxs)("div",{style:l.chatBody,children:[x.map((e=>{const n=e.senderId===g.uid;return(0,o.jsxs)("div",{style:{...l.messageBubble,alignSelf:n?"flex-end":"flex-start",backgroundColor:n?"#dcf8c6":"#ffffff"},children:[(0,o.jsx)("p",{style:l.messageText,children:e.message}),(0,o.jsxs)("div",{style:l.messageMeta,children:[(0,o.jsx)("span",{style:l.metaName,children:e.senderName}),(0,o.jsx)("span",{style:l.metaTime,children:(s=e.time,null===s||void 0===s?void 0:s.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))}),n&&(0,o.jsxs)("span",{style:l.metaStatus,children:["sent"===e.status&&"\u2713","delivered"===e.status&&"\u2713\u2713","seen"===e.status&&(0,o.jsx)("span",{style:{color:"#34B7F1"},children:"\u2713\u2713"})]})]})]},e.id);var s})),(0,o.jsx)("div",{ref:b})]}),(0,o.jsxs)("div",{style:l.chatInput,children:[(0,o.jsx)("input",{style:l.input,placeholder:"Type a message...",value:p,onChange:e=>u(e.target.value),onKeyDown:e=>"Enter"===e.key&&v()}),(0,o.jsx)("button",{style:l.sendBtn,onClick:v,children:"Send"})]})]}):(0,o.jsx)("div",{style:l.noChat,children:"Select a user to start chatting"})})]})]})}},999:(e,n,s)=>{s.d(n,{A:()=>c});var r=s(43),a=s(204),t=s(216),i=s(791),d=s(472),o=s(729),l=s(579);const c=()=>{const[e,n]=(0,r.useState)(""),[s,c]=(0,r.useState)([]),[x,f]=(0,r.useState)(!1),[p,u]=(0,r.useState)(!1),h=(0,t.Zp)(),m=(0,o.xI)().currentUser;(0,r.useEffect)((()=>{(async()=>{if(m)try{const e=(0,d.P)((0,d.rJ)(i.db,"webchat"),(0,d._M)("receiverId","==",m.uid),(0,d.My)("time","desc"));await(0,d.GG)(e)}catch(e){console.error("Error fetching messages:",e)}})()}),[m]);return(0,l.jsxs)("nav",{className:"navbar",children:[(0,l.jsxs)("div",{className:"navbar-main",children:[(0,l.jsx)("div",{className:"nav-left",children:(0,l.jsx)("div",{className:"navbar-logo",children:"PlanOra"})}),(0,l.jsx)("div",{className:"nav-center",children:(0,l.jsxs)("div",{className:"navbar-search",children:[(0,l.jsx)(a.KSO,{className:"search-icon"}),(0,l.jsx)("input",{type:"text",placeholder:"Search...",value:e,onChange:async e=>{const s=e.target.value;if(n(s),s){f(!0);try{const e=(0,d.P)((0,d.rJ)(i.db,"postorder"),(0,d._M)("businessname",">=",s),(0,d._M)("businessname","<=",s+"\uf8ff")),n=await(0,d.GG)(e);c(n.docs.map((e=>({id:e.id,...e.data()}))))}catch(r){console.error("Error fetching companies:",r)}finally{f(!1)}}else c([])}}),e&&(0,l.jsx)("div",{className:"search-results",children:x?(0,l.jsx)("div",{className:"loading",children:"Loading..."}):s.length?s.map((e=>(0,l.jsx)("div",{className:"result-item",onClick:()=>(h(`/company/${e.id}`),n(""),c([]),void u(!1)),children:e.businessname},e.id))):(0,l.jsx)("div",{className:"no-results",children:"No matches found"})})]})}),(0,l.jsx)("div",{className:"nav-right",children:(0,l.jsxs)("ul",{className:"nav-links "+(p?"active":""),children:[(0,l.jsx)("li",{onClick:()=>{h("/home"),u(!1)},children:"Home"}),(0,l.jsx)("li",{onClick:()=>{h("/orders"),u(!1)},children:"Orders"}),(0,l.jsx)("li",{onClick:()=>{h("/post-order"),u(!1)},children:"Post Order"}),(0,l.jsxs)("li",{onClick:()=>{h("/profile"),u(!1)},children:[(0,l.jsx)(a.x$1,{})," Profile"]}),(0,l.jsxs)("li",{onClick:()=>{h("/messages"),u(!1)},children:[(0,l.jsx)(a.maD,{})," Messages"]}),(0,l.jsxs)("li",{onClick:()=>{h("/cart"),u(!1)},children:[(0,l.jsx)(a.AsH,{})," Cart"]})]})}),(0,l.jsx)("div",{className:"hamburger",onClick:()=>u((e=>!e)),children:p?(0,l.jsx)(a.QCr,{}):(0,l.jsx)(a.OXb,{})})]}),(0,l.jsx)("style",{children:`\n        * {\n          box-sizing: border-box;\n          margin: 0;\n          padding: 0;\n        }\n        .navbar {\n          background: #003f66;\n          color: #fff;\n          padding: 0.5rem 1rem;\n          position: sticky;\n          top: 0;\n          z-index: 1000;\n        }\n        .navbar-main {\n          display: flex;\n          align-items: center;\n          justify-content: space-between;\n          flex-wrap: wrap;\n        }\n\n        .nav-left {\n          flex: 1;\n        }\n\n        .nav-center {\n          flex: 2;\n          display: flex;\n          justify-content: center;\n        }\n\n        .nav-right {\n          flex: 2;\n          display: flex;\n          justify-content: flex-end;\n        }\n\n        .navbar-logo {\n          font-size: 1.5rem;\n          font-weight: bold;\n        }\n\n        .navbar-search {\n          position: relative;\n          width: 100%;\n          max-width: 400px;\n          background: rgba(255,255,255,0.2);\n          border-radius: 20px;\n          display: flex;\n          align-items: center;\n          padding: 0.3rem 0.75rem;\n        }\n\n        .navbar-search input {\n          flex: 1;\n          background: transparent;\n          border: none;\n          color: #fff;\n          margin-left: 0.5rem;\n          font-size: 0.9rem;\n          outline: none;\n        }\n\n        .search-icon {\n          color: #ddd;\n        }\n\n        .search-results {\n          position: absolute;\n          top: 110%;\n          left: 0;\n          width: 100%;\n          background: #fff;\n          color: #333;\n          border-radius: 0 0 10px 10px;\n          box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n          max-height: 200px;\n          overflow-y: auto;\n          z-index: 1001;\n        }\n\n        .result-item, .loading, .no-results {\n          padding: 0.5rem;\n          border-bottom: 1px solid #eee;\n          cursor: pointer;\n        }\n\n        .result-item:hover {\n          background: #f0f0f0;\n        }\n\n        .hamburger {\n          display: none;\n          font-size: 1.5rem;\n          color: #fff;\n          cursor: pointer;\n        }\n\n        .nav-links {\n          list-style: none;\n          display: flex;\n          gap: 1.5rem;\n          align-items: center;\n        }\n\n        .nav-links li {\n          cursor: pointer;\n          padding: 0.5rem;\n          border-radius: 6px;\n          transition: background 0.2s;\n          display: flex;\n          align-items: center;\n          gap: 0.3rem;\n        }\n\n        .nav-links li:hover {\n          background: rgba(255, 255, 255, 0.2);\n        }\n\n        @media (max-width: 768px) {\n          .nav-center {\n            order: 3;\n            width: 100%;\n            margin-top: 10px;\n          }\n\n          .nav-right {\n            width: 100%;\n            justify-content: center;\n          }\n\n          .nav-links {\n            display: ${p?"flex":"none"};\n            flex-direction: column;\n            width: 100%;\n            margin-top: 1rem;\n          }\n\n          .hamburger {\n            display: block;\n          }\n        }\n      `})]})}}}]);
//# sourceMappingURL=215.8650196e.chunk.js.map